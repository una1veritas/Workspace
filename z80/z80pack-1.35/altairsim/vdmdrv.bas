0000 REM
0002 REM <<<  BASIC TO VDM-1 LINK PROGRAM  >>>
0004 REM
0006 REM      PROCESSOR TECHNOLOGY CORP.
0008 REM      6200 HOLLIS STREET
0010 REM      EMERYVILLE, CALIFORNIA   94608
0012 PRINT
0014 A$="(HEX) IS YOUR LAST ADDRESS, INPUT:"
0016 B$="GIVE ME YOUR VDM":C$="ADDRESS IN DECIMAL"
0018 PRINT "<<<  VDM TO BASIC LOADING AND LINKING PROGRAM  >>>"
0020 PRINT "    WRITTEN IN BASIC LANGUAGE BY GORDON FRENCH":PRINT
0022 PRINT "REMEMBER, IF YOU DID NOT LEAVE THE LAST 512 BYTES"
0024 PRINT "OF YOUR LAST 4K OF MEMORY FREE WHEN RESPONDING"
0026 PRINT "TO '' MEMORY SIZE ? '' WHEN THIS BASIC WAS"
0028 PRINT "LOADED, YOU MUST RELOAD BASIC WITH THE CORRECTED"
0030 PRINT "INFORMATION FOR ''MEMORY SIZE''.":PRINT:PRINT
0032 PRINT "INPUT DECIMAL NUMBER OF YOUR LAST 4K BOUNDRY"
0034 PRINT "(EXAMPLE: IF 4FFF "A$" 4(RETURN)"
0036 PRINT TAB(10)"IF 5FFF "A$" 5(RETURN)  "
0037 PRINT TAB(10)"IF AFFF "A$"10(RETURN)   ETC."
0038 INPUT L:IF L<=7 THEN S=0:GOTO 46
0040 PRINT "IS THIS 12K EXTENDED BASIC? (Y/N)":INPUT D$
0042 IF D$="Y" THEN S=65536:GOTO 46
0043 IF D$<>"N" THEN 40
0044 GOTO 84
0046 IF L>15 OR L=0 THEN 32
0048 L=(L*4096)+3584:P=L/256:L=L-S
0050 PRINT "IS YOUR VDM MEMORY ADDRESS CC00(HEX)";
0052 PRINT " WITH PORT=C8? (Y/N)"
0054 INPUT D$:IF D$="Y" GOTO 64
0055 IF D$<>"N" THEN 50
0056 PRINT B$" MEMORY STARTING "C$:INPUT V2
0058 V1=INT(V2/256):V2=((V2/256)-INT(V2/256))*256
0060 PRINT B$" PORT "C$:INPUT V3: IF V3>255 GOTO 60
0062 GOTO 68
0064 V1=204:V2=0:V3=200:V4=192
0068 PRINT "A MOMENT PLEASE..."
0070 S=0
0072 FOR K=0 TO 4096
0074 A=PEEK(K)
0076 B=PEEK(K+1)
0078 IF A=219 AND B=16 GOTO 92
0080 IF A=219 AND B=17 THEN I=K:GOTO 106
0082 NEXT K
0084 PRINT "IT IS NOT POSSIBLE TO LINK VDM-1";
0086 PRINT " TO THIS BASIC BY MEANS"
0088 PRINT "OF THIS PROGRAM.  SORRY!"
0090 GOTO 146
0092 IF S>0 THEN GOTO 100
0094 C=PEEK(K+2):D=PEEK(K+3):E=PEEK(K+4):F=K+4
0096 IF C<>230 THEN GOTO 82
0098 S=S+1:G=K:GOTO 82
0100 H=PEEK(K+3):J=0
0102 F=F-256:J=J+1:IF F>256 GOTO 102
0104 GOTO 82
0106 FOR Y=L TO L+416
0108 READ Z
0110 IF Z<300 GOTO 138
0112 IF Z=300 THEN Z=V3:GOTO 138
0114 IF Z=400 THEN Z=V2:GOTO 138
0116 IF Z=500 THEN Z=V1:GOTO 138
0118 IF Z=1001 THEN Z=P+1:GOTO 138
0120 IF Z=1000 THEN Z=P:GOTO 138
0122 IF Z=2000 THEN Z=D:GOTO 138
0124 IF Z=3000 THEN Z=E:GOTO 138
0126 IF Z=4000 THEN Z=F:GOTO 138
0128 IF Z=5000 THEN Z=J:GOTO 138
0130 IF Z=6000 THEN Z=H:GOTO 138
0132 PRINT "THIS PROGRAM LOAD IS BAD.";
0134 PRINT "  PLEASE RELOAD THIS PROGRAM."
0136 GOTO 146
0138 POKE Y,Z:NEXT Y
0140 POKE G,195:POKE G+1,0:POKE G+2,P
0142 POKE I,205:POKE I+1,110:POKE I+2,P+1:POKE I+3,0
0143 PRINT CHR$(26)
0144 PRINT "VDM-1 IS NOW LINKED TO BASIC":PRINT
0145 PRINT "DO NOT ATTEMPT TO RE-RUN THIS PROGRAM !":PRINT
0146 RESTORE
0148 NULL 0
0150 END
0152 DATA 219,255,31,210,13,1000,219,16,230,2000
0154 DATA 195,4000,5000,241,245,230,127,254,32,210,154
0156 DATA 1001,254,7,202,6,1000,254,13,202,47,1000
0158 DATA 254,1,202,47,1000,254,26,202,47,1000,241
0160 DATA 201,0,0,245,229,213,197
0162 DATA 205,58,1000,193,209,225,241,201,245,58
0164 DATA 146,1001,103,46,128,205,105,1001,3000,104
0166 DATA 1000,205,110,1001,50,140,1001,254,58,210
0168 DATA 112,1000,254,49,218,112,1000,230,15,79
0170 DATA 175,55,13,202,100,1000,23,195,92,1000
0172 DATA 50,146,1001,43,124,183,194,103,1000,195
0174 DATA 181,1000,254,32,194,103,1000,205,105,1001
0176 DATA 3000,117,1000,195,103,1000,33,400,500,124
0178 DATA 198,4,54,32,35,188,194,132,1000,175
0180 DATA 50,144,1001,50,145,1001,50,142,1001,47
0182 DATA 50,143,1001,62,15,50,141,1001,205,167
0184 DATA 1000,62,13,245,195,181,1000,58,144,1001
0186 DATA 7,7,7,7,33,145,1001,182,211,300
0188 DATA 201,58,142,1001,71,241,254,13,202,223
0190 DATA 1000,254,95,202,243,1000,254,1,202,3
0192 DATA 1001,254,26,202,126,1000,79,58,141,1001
0194 DATA 205,50,1001,113,58,142,1001,60,254,64
0196 DATA 194,233,1000,58,141,1001,205,97,1001,205
0198 DATA 20,1001,151,50,142,1001,71,58,141,1001
0200 DATA 195,69,1001,58,141,1001,205,97,1001,43
0202 DATA 54,32,5,58,141,1001,195,69,1001,58
0204 DATA 143,1001,47,50,143,1001,58,142,1001,71
0206 DATA 58,141,1001,195,69,1001,33,145,1001,229
0208 DATA 126,52,150,1,0,0,205,50,1001,1
0210 DATA 64,32,112,44,13,194,36,1001,225,126
0212 DATA 230,15,119,195,167,1000,111,58,145,1001
0214 DATA 133,15,15,111,230,3,198,500,103,125
0216 DATA 230,192,128,111,201,230,15,50,141,1001
0218 DATA 205,50,1001,120,50,142,1001,58,143,1001
0220 DATA 183,126,202,93,1001,246,128,119,201,230
0222 DATA 127,119,201,205,50,1001,126,230,127,119
0224 DATA 201,219,16,230,6000,201,58,140,1001,254
0226 DATA 3,194,125,1001,245,175,50,140,1001,241
0228 DATA 201,219,17,230,127,254,1,202,46,1000
0230 DATA 254,26,202,46,1000,201,0,0,0,1
0232 DATA 0,0,6,0,0,0,0,0,0,0
0233 DATA 254,127,194,47,1000,241,201
