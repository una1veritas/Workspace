 10 REM MODEM PROGRAM
 15 POKE133,80:CLEAR:FORI=1TO30:PRINT:NEXT
 20 PRINT"MODEM ROUTINE LOADING"
 30 Y=PEEK(2):Z=PEEK(64774)
 40 IFZ=32THENGOSUB3000:GOTO60
 50 GOSUB4000
 60 FORI=1TO32:PRINT:NEXT:PRINT"MODEM READY"
 70 X=USR(X):POKE63235,0:POKE64512,17
 80 RESTORE:GOSUB500:IFY=4THENX=PEEK(8960):POKE133,X:RUN"BEXEC*"
 90 END
 500 PS=1:IFPEEK(9800)=32THENPS=2
 510 IFY<>4ORZ<>32THENFORI=1TO48:READP:NEXT:RETURN
 520 READP,C(1),C(2):IFPTHENPOKEP,C(PS):GOTO520
 530 RETURN
 540 DATA 9730,8,16
 550 DATA 9743,7,15
 560 DATA 9723,31,63
 570 DATA 9736,31,63
 580 DATA 9725,4,10
 590 DATA 9738,29,59
 610 DATA 9800,32,64
 620 DATA 9636,101,75
 630 DATA 9766,101,75
 640 DATA 9770,101,75
 650 DATA 9815,101,75
 670 DATA 9670,125,123
 680 DATA 9783,125,123
 690 DATA 9682,95,164
 990 DATA55296,0,1,0,0,0
 1500 FORI=0+FTO216+F:READX
 1510 IFX=-1THENX=INT(I/256)
 1520 POKEI,X:NEXT
 1530 RETURN
 2000 DATA 32,13,37,173,0,240,74,144,6,173,1,240,32,67,35
 2010 DATA 32,93,-1,240,239,201,2,240,22,201,4,240,21,72,32
 2020 DATA 67,35,173,0,240,74,74,144,249,104,141,1,240,76,37
 2030 DATA -1,76,13,37,173,63,-1,73,12,141,63,-1,208,225,138
 2035 DATA 72,152,72
 2040 DATA 169,1,32,190,252,32,198,252,208,5,10,208,245,240,83
 2050 DATA 74,144,9,42,224,33,208,243,169,27,208,33,32,200,253
 2060 DATA 152,141,19,2,10,10,10,56,237,19,2,141,19,2,168,138
 2070 DATA 74,240,49,136,200,74,144,252,208,42,234,185,207,253,205
 2080 DATA 21,2,208,38,206,20,2,240,43,160,5,162,200,202,208,253
 2090 DATA 136,208,248,240,67,201,1,240,53,160,0,201,2,240,54,160
 2100 DATA 192,201,32,240,48,169,0,141,22,2,141,21,2,169,2,141
 2110 DATA 20,2,208,36,162,150,205,22,2,208,2,162,14,142,20,2
 2120 DATA 141,22,2,169,1,32,190,252,32,207,252,74,144,3,76
 2130 DATA 143,253,208,194,160,32,76,167,253,169,0,76,183,253
 3000 GOSUB500
 3005 IFY=4THENPOKE8955,34:POKE8956,82:F=21026:GOTO1500
 3008 F=546:GOSUB1500
 3010 POKE546,44:POKE592,96
 3020 POKE559,251:POKE560,2:POKE576,251:POKE577,2
 3030 POKE763,41:POKE764,127:POKE765,76:POKE766,45:POKE767,191
 3040 POKE11,34:POKE12,2:RETURN
 4000 GOSUB3000
 4010 POKEF+65,141:POKEF+66,0:POKEF+67,223
 4020 POKEF+68,174:POKEF+69,0:POKEF+70,223
 4030 POKEF+193,141:POKEF+194,0:POKEF+195,223
 4040 POKEF+196,173:POKEF+197,0:POKEF+198,223
 4050 POKEF+1,68:POKEF+2,38
 4060 POKEF+47,68:POKEF+48,38
 4070 POKEF+5,252:POKEF+11,252:POKEF+34,252:POKEF+42,252
 4080 IFY=4THENPOKE63235,52:POKE64512,2
 4090 RETURN
