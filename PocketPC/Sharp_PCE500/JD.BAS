100 'ASTROLOGICAL CALCULATION110 CLS120 LOCATE 0,0130 PRINT "C)AL TO JD/ J)D TO CAL                  "140 LOCATE 23,0:K$="":INPUT K$150 IF K$="C" THEN GOSUB 180160 IF K$="J" THEN GOSUB 320170 GOTO 140180 'CAL DATE TO JD190 K$=""200 LOCATE 0,1:INPUT "YYYYMMDD.dd=";K$210 IF K$="" THEN LOCATE 0,1: PRINT "YYYYMMDD.dd=";CDATE;"  " ELSE CDATE=VAL (K$)220 YSGN=SGN (CDATE):CDATE=ABS (CDATE)230 YY=YSGN*INT (CDATE/10000)240 MM=INT ((CDATE-ABS (YY*10000))/100)250 DD=CDATE-ABS (YY*10000)-MM*100260 PRINT YY;"/";MM;"/";DD270 IF MM <= 2 THEN YY=YY-1:MM=MM+12280 IF YSGN*CDATE >= 15821015 THEN A=INT (YY/100):B=2-A+INT (A/4) ELSE B=0290 IF YY >=0 THEN JD=INT (365.25*YY)+INT (30.6001*(MM+1))+DD+1720994.5+B ELSE JD=SGN (365.25*YY-0+75)*INT (ABS (365.25*YY-0.75))+INT (30.6001*(MM+1))+DD+1720994.5+B300 LOCATE 0,3 :PRINT "JD=";JD;"    "310 RETURN320 'JD TO CAL DATE330 K$=""340 LOCATE 0,1:INPUT "JD=";K$350 IF K$="" THEN LOCATE 0,1: PRINT "JD=";JD;"  " ELSE JD=VAL (K$)360 PRINT JD370 Z=INT (JD+0.5)380 F=(JD+0.5)-Z390 IF Z<2299161 THEN A=Z400 IF Z>=229161 THEN ALPHA=INT ((Z-1867216.25)/36524.25): A=Z+1+ALPHA-INT (ALPHA/4)410 B=A+1524420 C=INT ((B-122.1)/365.25)430 D=INT (365.25*C)440 E=INT ((B-D)/30.6001)450 DD=B-D-INT (30.6001*E)+F460 IF E <13.5 THEN MM=E-1 ELSE MM=E-13470 IF MM>2.5 THEN YY=C-4716 ELSE YY=C-4715475 CDATE=YY*10000+MM*100+DD480 PRINT YY;"/";MM;"/";DD490 RETURN.