2;select sum(num)*10000 as penalties from (select a.task_id,count(*),b.required_processors_ub,count(*)-CAST(b.required_processors_ub AS SIGNED) as num from timetableSQL a, task_properties b where a.task_id = b.task_id group by a.task_id,b.required_processors_lb having count(*)-CAST(b.required_processors_ub AS SIGNED) > 0) as t;
2;select sum(num)*10000 as penalties from (select a.task_id,count(*),b.required_processors_lb,CAST(b.required_processors_lb AS SIGNED)-count(*) as num from timetableSQL a, task_properties b where a.task_id = b.task_id group by a.task_id,b.required_processors_ub having CAST(b.required_processors_lb AS SIGNED)-count(*) > 0) as t;
2;select sum(num*weight) as penalties from (select a.processor_id,b.employment,count(*),b.total_periods_ub,(count(*) - CAST(b.total_periods_ub AS SIGNED)) as num from timetableSQL a, processor_properties b where a.processor_id = b.processor_id group by a.processor_id,b.total_periods_ub having count(*) - CAST(b.total_periods_ub AS SIGNED) > 0) as t,penalties p where (t.employment = 1 and p.name='R_WEEKOVER')or (t.employment = 2 and p.name='N_WEEKOVER');
2;select sum(num*weight) as penalties from (select a.processor_id,b.employment,count(*),b.total_periods_lb,IF(a.processor_id is null,b.total_periods_lb, (CAST(b.total_periods_lb AS SIGNED) - count(*))) as num from timetableSQL a right join processor_properties b on a.processor_id = b.processor_id group by a.processor_id ,b.processor_id, b.total_periods_lb having ((CAST(b.total_periods_lb AS SIGNED) - count(*)) > 0) or a.processor_id IS NULL) as t,penalties p where (t.employment = 1 and p.name='R_WEEKUNDER') or (t.employment = 2 and p.name='N_WEEKUNDER');
2;select (count(*)-40)*1000 as penalties from timetableSQL a,processor_properties b where b.employment = 2 and a.processor_id = b.processor_id having count(*) > 40;
2;select sum(over*weight) as penalties from (select processor_id,employment,total_days_ub,count(*) as days , count(*) - CAST(total_days_ub AS SIGNED) as over from (select a.processor_id ,c.employment,c.total_days_ub , b.day_id , count(*) from timetableSQL a , period_properties b , processor_properties c where a.period_id = b.period_id and a.processor_id = c.processor_id group by a.processor_id ,c.employment, c.total_days_ub , b.day_id) as t group by processor_id,total_days_ub having count(*) - CAST(total_days_ub AS SIGNED) > 0) as a ,penalties p where (a.employment = 1 and p.name='R_DAYSOVER')or (a.employment = 2 and p.name='N_DAYSOVER');
1;set @m:=(select count(*) from timetableSQL);
2;select (@m-count(*))*1000 as penalties from timetableSQL a , processor_qualification b , task_properties c where c.qualification_id = b.qualification_id and a.processor_id = b.processor_id and a.task_id = c.task_id;
1;call getPenalties4(@b);
2;select @b as penalties;
2;select sum(num) as penalties from (select a.processor_id,sum(b.preferred_level_proc) as num from timetableSQL a,processor_schedules b where a.period_id = b.period_id and a.processor_id = b.processor_id group by a.processor_id) as t;
