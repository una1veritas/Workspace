2;select (count(*)-40)*1000 as penalties from timetableSQL a,processor_properties b where b.employment = 2 and a.processor_id = b.processor_id having count(*) > 40;
2;select sum(over*weight) as penalties from (select processor_id,employment,total_days_ub,count(*) as days , count(*) - CAST(total_days_ub AS SIGNED) as over from (select a.processor_id ,c.employment,c.total_days_ub , b.day_id , count(*) from timetableSQL a , period_properties b , processor_properties c where a.period_id = b.period_id and a.processor_id = c.processor_id group by a.processor_id ,c.employment, c.total_days_ub , b.day_id) as t group by processor_id,total_days_ub having count(*) - CAST(total_days_ub AS SIGNED) > 0) as a ,penalties p where (a.employment = 1 and p.name='R_DAYSOVER')or (a.employment = 2 and p.name='N_DAYSOVER');
1;set @m:=(select count(*) from timetableSQL);
2;select (@m-count(*))*1000 as penalties from timetableSQL a , processor_qualification b , task_properties c where c.qualification_id = b.qualification_id and a.processor_id = b.processor_id and a.task_id = c.task_id;

1;create table t as select a.task_id,a.period_id,a.processor_id,c.employment,b.day_id from timetableSQL a,period_properties b ,processor_properties c where a.period_id = b.period_id and a.processor_id = c.processor_id;

2;select sum(weight) as penalties from (select a.processor_id,a.employment from t a , t b where a.period_id +1 != all(select period_id from t where a.processor_id = t.processor_id) and a.processor_id = b.processor_id and a.period_id = b.period_id - 2 and a.day_id = b.day_id) as c , penalties p where (c.employment = 1 and p.name='R_HOLE') or (c.employment = 2 and p.name='N_HOLE');
2;select sum(weight*2) as penalties from (select a.processor_id,a.employment from t a , t b where a.period_id+1 != all(select period_id from t where a.processor_id = t.processor_id)  and a.period_id+2 != all(select period_id from t where a.processor_id = t.processor_id) and a.processor_id = b.processor_id and a.period_id = b.period_id - 3 and a.day_id = b.day_id) as c , penalties p where (c.employment = 1 and p.name='R_HOLE') or (c.employment = 2 and p.name='N_HOLE');
2;select sum(weight*3) as penalties from (select a.processor_id,a.employment from t a , t b where  a.period_id+1 != all(select period_id from t where a.processor_id = t.processor_id)  and a.period_id+2 != all(select period_id from t where a.processor_id = t.processor_id) and a.period_id+3 != all(select period_id from t where a.processor_id = t.processor_id) and a.processor_id = b.processor_id and a.period_id = b.period_id - 4 and a.day_id = b.day_id) as c , penalties p where (c.employment = 1 and p.name='R_HOLE') or (c.employment = 2 and p.name='N_HOLE');
1;drop table t;

2;select sum(num) as penalties from (select a.processor_id,sum(b.preferred_level_proc) as num from timetableSQL a,processor_schedules b where a.period_id = b.period_id and a.processor_id = b.processor_id group by a.processor_id) as t;